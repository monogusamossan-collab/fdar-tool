<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FDAR記録支援ツール（両方）</title>
  <style>
    :root{color-scheme:light dark;}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;margin:12px;line-height:1.5}
    h1{font-size:20px;margin:0 0 12px}
    .tabs{display:flex;gap:8px;margin-bottom:10px;flex-wrap:wrap}
    .tab{border:1px solid rgba(127,127,127,.35);border-radius:999px;padding:8px 12px;background:transparent;color:inherit}
    .tab.active{background:#0a84ff;color:#fff;border-color:#0a84ff}
    .card{border:1px solid rgba(127,127,127,.35);border-radius:14px;padding:12px}
    label{display:block;font-size:12px;opacity:.85;margin:10px 0 6px}
    input,textarea{width:100%;box-sizing:border-box;border:1px solid rgba(127,127,127,.35);border-radius:12px;padding:10px 12px;background:transparent;color:inherit;font-size:16px}
    textarea{min-height:88px;resize:vertical}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row>*{flex:1 1 160px}
    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button.action{border:0;border-radius:12px;padding:10px 14px;font-size:16px}
    button.primary{background:#0a84ff;color:#fff}
    button.secondary{background:transparent;color:inherit;border:1px solid rgba(127,127,127,.35)}
    pre{white-space:pre-wrap;border:1px dashed rgba(127,127,127,.45);border-radius:12px;padding:10px;margin-top:10px;min-height:44px}
    .note{font-size:12px;opacity:.8;margin-top:8px}
    .hide{display:none}
  </style>
</head>
<body>
  <h1>FDAR記録支援ツール（両方）</h1>

  <div class="tabs">
    <button class="tab active" id="t-fdar">FDAR</button>
    <button class="tab" id="t-soap">SOAP</button>
  </div>

  <div class="card">
    <div class="row">
      <div>
        <label>利用者名（※個人情報は入力しない運用）</label>
        <input id="name" autocomplete="off" placeholder="例：A様" />
      </div>
      <div>
        <label>日付</label>
        <input id="date" autocomplete="off" placeholder="例：2026/02/07" />
      </div>
    </div>

    <!-- FDAR -->
    <div id="panel-fdar">
      <label>F（訴え・状況）</label>
      <textarea id="f" placeholder="例：本日も腰痛あり。歩行時に痛み増強。"></textarea>

      <label>D（評価・所見）</label>
      <textarea id="d" placeholder="例：立位で疼痛NRS○/10。体幹伸展で増悪。"></textarea>

      <label>A（対応・介入）</label>
      <textarea id="a_fdar" placeholder="例：体幹安定化練習、動作指導、疼痛緩和目的の徒手。"></textarea>

      <label>R（反応・結果）</label>
      <textarea id="r" placeholder="例：介入後、立位時痛み軽減。歩行距離が伸びた。"></textarea>
    </div>

    <!-- SOAP -->
    <div id="panel-soap" class="hide">
      <label>S（主観情報）</label>
      <textarea id="s" placeholder="例：歩くと腰が痛い。昨日より少しつらい。"></textarea>

      <label>O（客観情報）</label>
      <textarea id="o" placeholder="例：歩行○mで疼痛訴え。体幹伸展で痛み増悪。"></textarea>

      <label>A（評価）</label>
      <textarea id="a_soap" placeholder="例：腰部伸展負荷で疼痛誘発。動作パターンの影響が示唆。"></textarea>

      <label>P（計画）</label>
      <textarea id="p" placeholder="例：体幹安定化練習・動作指導継続。次回は立ち上がり動作を評価。"></textarea>
    </div>

    <div class="btns">
      <button class="action primary" id="build">作成</button>
      <button class="action secondary" id="copy">コピー</button>
      <button class="action secondary" id="clear">クリア</button>
    </div>

    <pre id="out"></pre>
    <div class="note">※「作成」→「コピー」でそのまま記録に貼れます</div>
  </div>

<script>
  const $ = (id)=>document.getElementById(id);

  let mode = "fdar";

  function setMode(next){
    mode = next;
    $("panel-fdar").classList.toggle("hide", mode !== "fdar");
    $("panel-soap").classList.toggle("hide", mode !== "soap");
    $("t-fdar").classList.toggle("active", mode === "fdar");
    $("t-soap").classList.toggle("active", mode === "soap");
    $("out").textContent = "";
  }

  $("t-fdar").addEventListener("click", ()=>setMode("fdar"));
  $("t-soap").addEventListener("click", ()=>setMode("soap"));

  function buildText(){
    const name = $("name").value.trim();
    const date = $("date").value.trim();
    const head = (name || date) ? `【${name || "利用者"}】${date ? "（" + date + "）" : ""}\n` : "";

    if(mode === "fdar"){
      const F = $("f").value.trim();
      const D = $("d").value.trim();
      const A = $("a_fdar").value.trim();
      const R = $("r").value.trim();
      const lines = [];
      if(F) lines.push(`F：${F}`);
      if(D) lines.push(`D：${D}`);
      if(A) lines.push(`A：${A}`);
      if(R) lines.push(`R：${R}`);
      return head + lines.join("\n");
    }else{
      const S = $("s").value.trim();
      const O = $("o").value.trim();
      const A = $("a_soap").value.trim();
      const P = $("p").value.trim();
      const lines = [];
      if(S) lines.push(`S：${S}`);
      if(O) lines.push(`O：${O}`);
      if(A) lines.push(`A：${A}`);
      if(P) lines.push(`P：${P}`);
      return head + lines.join("\n");
    }
  }

  $("build").addEventListener("click", ()=>{
    $("out").textContent = buildText().trim();
  });

  $("copy").addEventListener("click", async ()=>{
    const text = ($("out").textContent || buildText()).trim();
    try{
      await navigator.clipboard.writeText(text);
    }catch(e){
      const range = document.createRange();
      range.selectNodeContents($("out"));
      const sel = window.getSelection();
      sel.removeAllRanges();
      sel.addRange(range);
      document.execCommand("copy");
      sel.removeAllRanges();
    }
  });

  $("clear").addEventListener("click", ()=>{
    ["name","date","f","d","a_fdar","r","s","o","a_soap","p"].forEach(id=>{
      const el = $(id);
      if(el) el.value = "";
    });
    $("out").textContent = "";
  });
</script>
</body>
</html>
